# Техническое описание курсового проекта
## Авторы:
Злобина Полина Сергеевна  
Петухова Дарья Андреевна  
в5130904/10321

## Название приложения:
Микросервис для поиска еды в базе данных.

## Краткое описание приложения:
Приложение представляет собой серверную часть, обладающую функциональностью для взаимодействия с базой данных.  
Основная функциональность включает сохранение, обновление, удаление и поиск информации о различных блюдах по их уникальному идентификатору или наименованию в базе данных. 
Идеей приложения является загрузка в базу данных информации о названиях блюд и их ценах.  
У пользователей есть возможность сформировать запросы к приложению для получения списка блюд или удаления их из базы данных.  
Таким образом, серверная часть приложения обеспечивает обработку запросов, связанных с объектами еды, их управление и связь с базой данных

## Функциональные требования:
Микросервис должен реализовывать:  
Сохранение информации о новом блюде:
-	Микросервис должен принимать запрос типа POST с данными о блюде.
-	После сохранения информации о блюде в базе данных микросервис должен возвращать сохраненный объект блюда. 

Поиск блюда по идентификатору:
-	Микросервис должен обрабатывать запрос типа GET для поиска блюда по его уникальному идентификатору или наименованию.
-	Должна быть возможность возвращать информацию о блюде по указанному идентификатору или наименованию.  

Получение списка всех блюд:
-	Микросервис должен предоставлять запрос типа GET для получения списка всех блюд из базы данных.

Обновление информации о блюде:
-	Микросервис должен обрабатывать запрос типа PUT для обновления информации о блюде.
-	Должна быть возможность обновления информации о блюде на основе предоставленных данных.  
     
Удаление блюда:
-	Микросервис должен обеспечивать возможность удаления информации о блюде в базе данных по запросу типа DELETE.
     
При возникновении ошибки в микросервисе, необходимо предусмотреть соответствующую обработку, чтобы обеспечить надежность и устойчивость системы. 

## Описание базы данных:
База данных представлена в виде таблицы food и содержит следующие поля:  
id BIGSERIAL PRIMARY KEY,  
title VARCHAR(255) NOT NULL,  
price float NOT NULL  

## Диаграмма классов:
![food_delivery.png](\pic\food_delivery.png)
![food_delivery.png](https://github.com/spbstu-ngsmirnov/06-course-doc-zlobina_petukhova/blob/9deafce10529c39240760676fcb247da6fa74410/pic/food_delivery.png)  

Food: этот класс содержит основные методы для работы с объектами типа Food.  

FoodDto: этот класс содержит методы для работы с базой данных, включая операции получения и установки данных.  

FoodRepository: этот интерфейс предоставляет методы для выполнения операций CRUD с базой данных.  

FoodMapper: этот класс выполняет преобразование объектов типа Food - преобразовывать объекты Food в объекты FoodDto для сохранения в базе данных.  

FoodController: этот класс принимает HTTP-запросы, связанные с операциями над блюдами. Он содержит обработчики для различных эндпоинтов и использует FoodDataService для выполнения соответствующих операций.  

FoodDataService: этот класс является сервисным слоем, который реализует логику приложения, связанную с базой данных. Он предоставляет методы для сохранения, обновления, удаления и поиска информации о блюдах. FoodDataService использует интерфейс FoodService, который абстрагирует его от реализации и делает его более гибким.  

FoodService: этот интерфейс, который определяет контракты для операций, связанных с блюдами. Использование интерфейса позволяет разделить логику от ее конкретной реализации, что улучшает гибкость и поддерживаемость приложения.  

FoodNotFoundException: этот класс обрабатывает ошибки, связанные с отсутствием данных о продукте типа Food.

## Отчет о выполнении основных тестовых сценариев:
Поиск блюда по идентификатору:  
 - Цель: Отправить запрос на поиск блюда по уникальному идентификатору.
   1. Шаги выполнения:
      - Устанавливает ожидаемый идентификатор
      - Создает ожидаемый объект Food с заданными параметрами (идентификатор, название и цену).
      - Использует мок-объект foodService, чтобы замокировать вызов метода findById(id) с ожидаемым id и возвращаемым объектом expectedFood.
      - Выполняет HTTP GET-запрос к эндпоинту /findById, передавая параметр id.
      - Проверяет, что получен ответ с кодом состояния 200 (OK) и что JSON-ответ содержит поле id, значение которого равно ожидаемому id.
      - Проверяет, что метод findById(id) вызывается только один раз с указанным id.
   2. Результат:
      - Блюдо с соответствующим ID найдено.
      - Выведены данные из базы данных о найденной записи. 

Поиск блюда по наименованию:
- Цель: Отправить запрос на поиск блюда по наименованию.
  1. Шаги выполнения:
     - Определяет строку name, которая является названием продукта, по которому будет выполнен поиск.
     - Создает ожидаемый объект Food с заданными параметрами (идентификатор, название и цену).
     - Использует мок-объект foodService, чтобы замокировать вызов метода findByName(name) с ожидаемым name и возвращаемым объектом expectedFood.
     - Выполняет HTTP GET-запрос к эндпоинту /findByName, передавая параметр name.
     - Проверяет, что получен ответ с кодом состояния 200 (OK) и что JSON-ответ содержит массив, где первый элемент имеет поле title, значение которого равно ожидаемому name.
     - Проверяет, что метод findByName(name) вызывается только один раз с указанным name.
  2. Результат:
     - Блюдо с соответствующим наименованием найдено.
     - Получены данные из базы данных о найденной записи.

Получение списка всех блюд:
- Цель: Отправить запрос на получение списка всех блюд.
  1. Шаги выполнения:
    - Создает пустой объект Food, который представляет ожидаемый результат получения списка всех блюд.
    - Использует мок-объект foodService, чтобы замокировать вызов метода findAll() и возвращаемый список, содержащий только один элемент - expectedFood.
    - Выполняет HTTP GET-запрос к эндпоинту /getAll без передачи параметров.
    - Проверяет, что получен ответ с кодом состояния 200 (OK), что означает успешное выполнение запроса.
    - Проверяет, что метод findAll() вызывается только один раз.
  2. Результат:
    - Получены данные из базы данных о найденных записях.

Добавление нового блюда:
- Цель: Отправить запрос на добавление нового блюда.
  1. Шаги выполнения:
     - Создает объект FoodDto, представляющий данные о продукте, которые будут переданы в запросе сохранения.
     - Задает название продукта и его цену в объекте foodDto.
     - Использует мок-объект foodRepository, чтобы замокировать вызов метода saveAndFlush() и возвращаемый объект food.
     - Создает экземпляр MockMvc, используя контроллер foodController.
     - Выполняет HTTP POST-запрос к эндпоинту /save, передавая данные блюда.
     - Проверяет, что получен ответ с кодом состояния 200 (OK), что означает успешное выполнение запроса сохранения.
     - Проверяет, что метод saveAndFlush(any(Food.class)) вызывается только один раз с аргументом food.
  2. Результат:
     - Получены данные из базы данных о найденных записях.


## Иллюстрация работы микросервиса  
Запросы GET  
- Вывод всего списка блюд
![getAll.png](\pic\getAll.png)
- Вывод блюда по номеру ID
![findByID.png](\pic\findByID.png)
- Вывод блюда по названию
![findByName.png](\pic\findByName.png)

Запрос POST
- Сохранение нового блюда в базе данных
![save.png](\pic\save.png)

Запрос PUT
- Обновление данных о блюде в базе данных
![update.png](\pic\update.png)

Запрос DELETE
- Удаление данных о блюде из базы данных
![delete.png](\pic\delete.png)

Логирование ошибок, происодящих во время работы программы  
![logs.png](\pic\logs.png)

## Вывод
Микросервис удовлетворяет описанному выше функционалу: микросервис позволяет пользователям загружать, обновлять, удалять и осуществлять поиск информации о блюдах в базе данных, обеспечивая удобный доступ к этим данным.  

Во время разработки проекта команда тесно взаимодействовала друг с другом. 
Весь проект был написан в процессе видео созвонов и расшаривания экранов, 
а также, обсуждения идей, поиска информации, решений в процесссе.  
Статистика вклада авторов в проект составляет: 

Командный:
- написание тз и технического описания проекта
- создание API-спецификации и диаграммы классов
- написание следующих классов:
    - Food
    - FoodMapper
    - FoodRepository
    - FoodNotFoundException
- написание тестов и тестрирование
- процент покрытия кода составляет 75%

Полина:   
- написание обработки запросов (FoodService, FoodDataService) 

Дарья:
- написание обработчика запросов (FoodController)   
- создание базы данных

